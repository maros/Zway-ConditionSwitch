{
    "author": "Maroš Kollár",
    "category": "automation_basic",
    "defaults": {
        "description": "__m_descr__",
        "title": "__m_title__"
    },
    "dependencies": [
        "Cron",
        "BaseModule",
        "Presence"
    ],
    "homepage": "https://github.com/maros/Zway-ConditionSwitch/",
    "icon": "icon.png",
    "maturity": "stable",
    "moduleName": "ConditionSwitch",
    "options": {
        "definitions": {
            "conditions": {
                "fields": {
                    "type": {
                        "noneLabel": "__type_choose__",
                        "removeDefaultNone": false,
                        "order": 1,
                        "optionLabels": [
                            "__binary_label__",
                            "__multilevel_label__",
                            "__presence_mode_label__",
                            "__time_label__",
                            "__condition_elements_label__"
                        ]
                    },
                    "binaryDevice": {
                        "dependencies": {
                            "type": "binary"
                        },
                        "label": "__device_label__",
                        "order": 2,
                        "datasource": "namespaces",
                        "field": "optionLabels",
                        "optionLabels": "namespaces:devices_sensorBinary:deviceName,namespaces:devices_switchBinary:deviceName",
                        "type": "select"
                    },
                    "binaryValue": {
                        "dependencies": {
                            "type": "binary"
                        },
                        "label": "__value_label__",
                        "order": 3
                    },
                    "multilevelDevice": {
                        "dependencies": {
                            "type": "multilevel"
                        },
                        "order": 4,
                        "label": "__device_label__",
                        "datasource": "namespaces",
                        "field": "optionLabels",
                        "optionLabels": "namespaces:devices_sensorMultilevel:deviceName,namespaces:devices_switchMultilevel:deviceName",
                        "type": "select"
                    },
                    "multilevelOperator": {
                        "dependencies": {
                            "type": "multilevel"
                        },
                        "order": 5,
                        "label": "__operator_label__",
                        "optionLabels": [
                             "=",
                             "≠",
                             ">",
                             "≥",
                             "<",
                             "≤"
                         ],
                        "type": "select"
                    },
                    "multilevelValue": {
                        "dependencies": {
                            "type": "multilevel"
                        },
                        "label": "__value_label__",
                        "order": 6
                    },
                    "presenceMode": {
                        "dependencies": {
                            "type": "presenceMode"
                        },
                        "order": 7,
                        "label": "__presence_mode_label__",
                        "helper": "__presence_mode_helper__",
                        "optionLabels": [
                            "__presence_mode_home__",
                            "__presence_mode_away__",
                            "__presence_mode_vacation__",
                            "__presence_mode_night__"
                        ],
                        "type": "checkbox"
                    },
                    "time": {
                        "dependencies": {
                            "type": "time"
                        },
                        "order": 8,
                        "helper": "__time_helper__",
                        "items": {
                            "fields": {
                                "dayofweek": {
                                    "helper": "__time_dayofweek_label__",
                                    "optionLabels": [
                                     "__dayofweek_0__",
                                     "__dayofweek_1__",
                                     "__dayofweek_2__",
                                     "__dayofweek_3__",
                                     "__dayofweek_4__",
                                     "__dayofweek_5__",
                                     "__dayofweek_6__"
                                     ],
                                     "type": "checkbox"
                                },
                                "timeFrom": {
                                    "label": "__time_from_label__",
                                    "maskString": "99:99",
                                    "placeholder": "__time_placeholder__",
                                    "type": "time"
                                },
                                "timeTo": {
                                    "label": "__time_to_label__",
                                    "maskString": "99:99",
                                    "placeholder": "__time_placeholder__",
                                    "type": "time"
                                }
                            }
                        }
                    },
                    "conditionJunction": {
                        "dependencies": {
                            "type": "condition"
                        },
                        "label": "__condition_junction_label__",
                        "helper": "__condition_junction_helper__",
                        "order": 9,
                        "optionLabels": [
                            "__junction_and__",
                            "__junction_or__"
                        ]
                    },
                    "conditionElements": {
                        "dependencies": {
                            "type": "condition"
                        },
                        "label": "__condition_elements_label__",
                        "fields": {
                            "$ref": "#/definitions/conditions"
                        },
                        "order": 10
                    }
                }
            }
        },
        "fields": {
            "condition": {
                "label": "__condition_label__",
                "label": "__condition_helper__",

                "$ref": "#/definitions/conditions"
            },
            "switches": {
                "helper": "__switches_helper__",
                "items": {
                    "fields": {
                        "switchBinary": {
                            "order": 2,
                            "dependencies": {
                                "type": "switchBinary"
                            },
                            "fields": {
                                "device": {
                                    "datasource": "namespaces",
                                    "field": "optionLabels",
                                    "noneLabel": "__device_choose__",
                                    "removeDefaultNone": false,
                                    "optionLabels": "namespaces:devices_switchBinary:deviceName",
                                    "type": "select",
                                    "order": 1
                                },
                                "status": {
                                    "optionLabels": [
                                        "__on__",
                                        "__off__"
                                    ],
                                    "type": "radio",
                                    "order": 2
                                }
                            }
                        },
                        "switchMultilevel": {
                            "order": 3,
                            "dependencies": {
                                "type": "switchMultilevel"
                            },
                            "fields": {
                                "device": {
                                    "datasource": "namespaces",
                                    "field": "optionLabels",
                                    "noneLabel": "__device_choose__",
                                    "optionLabels": "namespaces:devices_switchMultilevel:deviceName,namespaces:devices_switchRGBW:deviceName",
                                    "removeDefaultNone": false,
                                    "type": "select",
                                    "order": 1
                                },
                                "level": {
                                    "dependencies": {
                                        "status": "level"
                                    },
                                    "order": 3
                                },
                                "status": {
                                    "optionLabels": [
                                        "__on__",
                                        "__off__",
                                        "__level__"
                                    ],
                                    "order": 2,
                                    "type": "radio"
                                }
                            }
                        },
                        "toggleButton": {
                            "order": 4,
                            "dependencies": {
                                "type": "toggleButton"
                            },
                            "fields": {
                                "endScene": {
                                    "datasource": "namespaces",
                                    "field": "optionLabels",
                                    "helper": "__end_scene_helper__",
                                    "label": "__end_scene_label__",
                                    "noneLabel": "__device_choose__",
                                    "optionLabels": "namespaces:devices_toggleButton:deviceName",
                                    "removeDefaultNone": false,
                                    "type": "select",
                                    "order": 2
                                },
                                "startScene": {
                                    "datasource": "namespaces",
                                    "field": "optionLabels",
                                    "helper": "__start_scene_helper__",
                                    "label": "__start_scene_label__",
                                    "noneLabel": "__device_choose__",
                                    "optionLabels": "namespaces:devices_toggleButton:deviceName",
                                    "removeDefaultNone": false,
                                    "type": "select",
                                    "order": 1
                                }
                            }
                        },
                        "type": {
                            "order": 1,
                            "label": "__label_type__",
                            "noneLabel": "__type_choose__",
                            "optionLabels": [
                                "__type_binary__",
                                "__type_multilevel__",
                                "__type_toggle__"
                            ],
                            "removeDefaultNone": false,
                            "type": "select"
                        }
                    }
                },
                "label": "__switches_label__",
                "order": 5
            }
        }
    },
    "repository": {
        "source": "https://github.com/maros/Zway-ConditionSwitch",
        "type": "git"
    },
    "schema": {
        "definitions": {
            "conditions": {
                "type": "object",
                "properties": {
                    "type": {
                        "enum": [
                            "binary",
                            "multilevel",
                            "presenceMode",
                            "time",
                            "condition"
                        ],
                        "required": true,
                        "type": "string"
                    },
                    "binaryDevice": {
                        "dependencies": "type",
                        "datasource": "namespaces",
                        "enum": "namespaces:devices_sensorBinary:deviceId,namespaces:devices_switchBinary:deviceId",
                        "field": "enum",
                        "required": true
                    },
                    "binaryValue": {
                        "dependencies": "type",
                        "default": "on",
                        "enum": [
                         "off",
                         "on"
                         ],
                         "required": true,
                         "type": "string"
                    },
                    "multilevelDevice": {
                        "dependencies": "type",
                        "datasource": "namespaces",
                        "enum": "namespaces:devices_sensorMultilevel:deviceId,namespaces:devices_switchMultilevel:deviceId,namespaces:devices_battery:deviceId",
                        "field": "enum",
                        "required": true
                    },
                    "multilevelOperator": {
                        "dependencies": "type",
                        "enum": [
                            "=",
                            "!=",
                            ">",
                            ">=",
                            "<",
                            "<="
                        ],
                        "required": true,
                        "type": "string"
                    },
                    "multilevelValue": {
                        "dependencies": "type",
                        "required": true,
                        "type": "number"
                    },
                    "presenceMode": {
                        "dependencies": "type",
                        "enum": [
                            "home",
                            "away",
                            "vacation",
                            "night"
                        ],
                        "minItems": 1,
                        "type": "array"
                    },
                    "time": {
                        "type": "array",
                        "dependencies": "type",
                        "minItem": 1,
                        "items": {
                            "type": "object",
                            "properties": {
                                "dayofweek": {
                                   "enum": [
                                     "0",
                                     "1",
                                     "2",
                                     "3",
                                     "4",
                                     "5",
                                     "6"
                                    ],
                                    "type": "array"
                                },
                                "timeFrom": {
                                    "pattern": "^([01]?[0-9]|2[0-3]):([0-5][0-9])$",
                                    "placeholder": "__time_placeholder__",
                                    "required": true,
                                    "type": "string"
                                },
                                "timeTo": {
                                    "pattern": "^([01]?[0-9]|2[0-3]):([0-5][0-9])$",
                                    "placeholder": "__time_placeholder__",
                                    "required": true,
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "conditionJunction": {
                        "dependencies": "type",
                        "enum": [
                            "and",
                            "or"
                        ],
                        "default": "and",
                        "required": true
                    },
                    "conditionElements": {
                        "dependencies": "type",
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/conditions"
                        },
                        "minItems": 1
                    }
                }
            }
        },
        "properties": {
            "condition": {
                "$ref": "#/definitions/conditions"
            },
            "switches": {
                "items": {
                    "properties": {
                        "switchBinary": {
                            "dependencies": "type",
                            "properties": {
                                "device": {
                                    "datasource": "namespaces",
                                    "enum": "namespaces:devices_switchBinary:deviceId",
                                    "field": "enum",
                                    "required": true,
                                    "type": "string"
                                },
                                "status": {
                                    "enum": [
                                        "on",
                                        "off"
                                    ],
                                    "required": true,
                                    "type": "integer"
                                }
                            },
                            "type": "object"
                        },
                        "switchMultilevel": {
                            "dependencies": "type",
                            "properties": {
                                "device": {
                                    "datasource": "namespaces",
                                    "enum": "namespaces:devices_switchMultilevel:deviceId,namespaces:devices_switchRGBW:deviceId",
                                    "field": "enum",
                                    "required": true,
                                    "type": "string"
                                },
                                "level": {
                                    "dependencies": "status",
                                    "maximum": "99",
                                    "minimum": "0",
                                    "required": true,
                                    "type": "integer"
                                },
                                "status": {
                                    "enum": [
                                        "on",
                                        "off",
                                        "level"
                                    ],
                                    "required": true,
                                    "type": "string"
                                }
                            },
                            "type": "object"
                        },
                        "toggleButton": {
                            "dependencies": "type",
                            "properties": {
                                "endScene": {
                                    "datasource": "namespaces",
                                    "enum": "namespaces:devices_toggleButton:deviceId",
                                    "field": "enum",
                                    "type": "string"
                                },
                                "startScene": {
                                    "datasource": "namespaces",
                                    "enum": "namespaces:devices_toggleButton:deviceId",
                                    "field": "enum",
                                    "required": true,
                                    "type": "string"
                                }
                            },
                            "type": "object"
                        },
                        "type": {
                            "enum": [
                                "switchBinary",
                                "switchMultilevel",
                                "toggleButton"
                            ],
                            "required": true,
                            "type": "string"
                        }
                    },
                    "type": "object"
                },
                "type": "array"
            }
        },
        "required": true,
        "type": "object"
    },
    "singleton": false,
    "version": 1.03
}